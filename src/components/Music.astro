---
const { music_text = "Nothing playing" } = Astro.props;
---

<div class="music-container" id="music-container">
  <span class="m-auto w-fit">Listening to {music_text}</span>
</div>

<script>
  const updateMusicText = async () => {
    try {
      const response = await fetch("/api/spotify.json");
      const data = await response.json();
      const container = document.getElementById("music-container");
      if (container) {
        const span = container.querySelector("span");
        if (span) {
          span.textContent = `Listening to ${data.song} by ${data.artist}`;
        }
      }
    } catch (error) {
      console.error("Failed to fetch music data:", error);
    }
  };

  // Update initially
  updateMusicText();

  // Update every minute
  setInterval(updateMusicText, 60000);
</script>

<style>
  .music-container {
    @apply flex flex-row items-center justify-center gap-3 text-base leading-6 text-copy-secondary animate-fade-in-right;
  }
</style>
